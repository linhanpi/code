---
title: 知乎穿乱做
description: 乱做知乎穿
katex: true
tags:
  - 知乎穿
categories:
  - 知乎穿
  - 做题记录
abbrlink: zifuchuanluanzuo
sticky: 2
swiper_index: 2
date: 2023-05-22 21:28:03
updated: 2023-05-22 22:00:00
cover: https://cdn.luogu.com.cn/upload/image_hosting/2mc45zx1.png
---
##### 1. [P2414 阿狸的打字机](https://www.luogu.com.cn/problem/P2414)

> 给出一颗 Trie 树， $q$ 次询问 $x$ 代表的串在 $y$ 代表的串中出现了多少次
> ${1\le n\le 10^{5},\ 1\le q \le 10^{5}}$
> 难度评分：2

板子题，放在 fail 树上解决。离线，将询问对 $x$ 分类，显然的想法是对 $x$ 的所有点执行到根的路径加，查询 $end_{y}$ 的单点值，树剖套线段树维护做到 $\mathcal{O(|S|\log^2|S|)}$ 。不想写树剖，观察到所有链加都直接到根且查询都是单点，使用树上差分将其转化为单点加 & 子树求和，将 fail 树拍平成 dfs 序，用树状数组维护最终复杂度 $\mathcal{O(|S|\log|S|)}$ 。

* 树上差分将树拍成 dfs 序维护较简单的信息

[code](https://www.bilibili.com/video/BV1GJ411x7h7/)

##### 2. [P2336 喵星球上的点名](https://www.luogu.com.cn/problem/P2336)

> 给出 $n$ 个模式串 $s_{i}$ ， $m$ 个文本串 $t_{i}$ 求
>
> * 每个文本串是多少模式串的子串
> * 每个模式串包含多少文本串
>
> ${1\le n\le 5\times 10^{4},\ 1\le m \le 10^{5}},|S| \le 10^{5},\sum \le 10^4$
> 难度评分：3

对于第一问答案求法同上题，重点在于去重。使用**链并**，对于 $s_{i}$ 的所有节点 $u$ 按照 dfs 序排序，对于相邻的节点求出 $lca$ ，对于 $u$ 执行到根的路径加，对于 $lca$ 执行到根的路径减，同样可以通过树上差分做到 $\mathcal{O(|S|\log|S|)}$ 。第二问做法相似。
注意字符集在 $10^{4}$ 级别，构造自动机时采用暴力跳 fail 复杂度不太对劲，记忆化即可。

* 链并去重
* 字符集较大时暴力跳 fail 并记忆化构造自动机

[code](https://github.com/linhanpi/code/blob/main/code/%E5%AD%97%E7%AC%A6%E4%B8%B2/AC%E8%87%AA%E5%8A%A8%E6%9C%BA/P2336_%E3%80%8CSCOI2012%E3%80%8D_%E5%96%B5%E6%98%9F%E7%90%83%E4%B8%8A%E7%9A%84%E7%82%B9%E5%90%8D.cpp)
