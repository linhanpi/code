---
title: 网络流小记
top: 0
toc: true
recommend: 100 
keywords: 网络流
date: 2023-03-11 22:10:43
thumbnail: https://cdn.luogu.com.cn/upload/image_hosting/m8gdxwl3.png
tags: 网络流
categories: [图论:网络流]
my: tulun/wangluoliu
---

## 前言

> 网络流作为图论中思维难度较高的一部分，内容较多且繁杂，为记录梳理网络流的学习，故作此文

---

## $\mathcal{Part\ 0}\ 定义$

* **流网络** $\mathrm{G=\left \langle V,E \right \rangle}$ 是一张有向图
* $\mathrm{ \forall\ (u,v)\in E\ 有\ (v,u)\notin E}$ ，若一条边在流网络中则它的反向边不在此流网络中
* $\mathrm{\forall\ (u,v) \in E \ }$有容量函数$\mathrm{\ \mathbf{c(u,v)}\ge 0}$，$\mathrm{\forall\ (u,v) \notin E \ 规定\ \mathbf{c(u,v)}= 0}$
* 规定两个特殊节点 **源点** $\mathrm{st}$ ，**汇点** $\mathrm{ed}$
* **流** $\mathbf{f}$ 是一个定义在 $\mathrm{E}$ 上的实值函数满足
  * **容量限制**：$\mathrm{\forall\ (u,v)\in E\ 有\ \mathbf{f(u,v)\le c(u,v)}}$
  * **流量守恒**：$\mathrm{\forall\ u\in V-\left \{st,ed\right \}\ 有\ \sum_{v\in V}\mathbf{f(v,u)} =\sum_{v\in V}\mathbf{f(v,u)}}$ 除源汇点外入流量等于出流量
  * 流 $\mathbf{f}$ 的**流量** $\mathbf{\left | f \right | }=$

## $\mathcal{Part\ 1}\ 最大流$

对于一个网络，使整个网络流量最大的流函数被称为网络的**最大流**，此时网络的流量被称为网络的**最大流量**

### $\mathcal{Part\ 1.2}\ \mathcal{Dinic}$ 算法

#### 流程

1. 在残量网络上 $\text{BFS}$ 构造**分层图**，分层图以 $\text{st}$ 到 $\text{x}$ 最少要经过的边数分层，在层数相差为 $1$ 的节点之间连边，显然分层图是一张 **$\text{DAG}$**
2. 在构造出来的分层图上 $\text{DFS}$ 找增广路，在回溯时更新剩余容量
3. 不断重复以上步骤直到残量网络中 $\text{st}$ 与 $\text{ed}$ 不连通

加剪枝和优化后，时间复杂度 **$\mathcal{O(n^2m)}$**

### $\mathcal{Isap}$ 算法

$\mathcal{Dinic}$ 基础上通过只进行一次 $\text{BFS}$ 对于常数进行优化，随机数据下速度在 $\mathcal{Dinic}$ $10$ 倍左右

#### 流程

1. 从 **$\text{ed}$** **到** **$\text{st}$** 进行一遍 $\text{BFS}$ 构造分层图
2. 从 $\text{st}$ 到 $\text{ed}$ 进行 $\text{DFS}$，当一个点增广结束后，若此时未用完上一个点传下来的流量则将它在分层图上的深度 $+1$ ，如果某个深度没有点，则结束算法
3. 若第 $2$ 步没有结束，则重复第 $2$ 步

[${\large \mathfrak{Code} } $](https://github.com/linhanpi/code/blob/main/code/%E5%9B%BE%E8%AE%BA/%E7%BD%91%E7%BB%9C%E6%B5%81/%E6%9C%80%E5%A4%A7%E6%B5%81/%E3%80%8C%E6%A8%A1%E6%9D%BF%E3%80%8D_ISAP.cpp)
