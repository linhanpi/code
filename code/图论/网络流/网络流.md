---
title: 网络流小记
top: 1
toc: true
recommend: 1 
keywords: 网络流
date: 2023-02-18 22:10:43
thumbnail: https://cdn.luogu.com.cn/upload/image_hosting/m8gdxwl3.png
tags: 网络流
categories: [图论:网络流]
my: tulun/wangluoliu
---

# 网络流小记

---

## 最大流

对于一个网络，使整个网络流量最大的流函数被称为网络的**最大流**，此时网络的流量被称为网络的**最大流量**

### $\mathcal{Dinic}$ 算法

#### 残量网络

网络中所有节点和剩余容量**大于 $0$** 的边构成的子图

#### 流程

1. 在残量网络上 $\text{BFS}$ 构造**分层图**，分层图以 $\text{St}$ 到 $\text{x}$ 最少要经过的边数分层，在层数相差为 $1$ 的节点之间连边，显然分层图是一张 **$\text{DAG}$**
2. 在构造出来的分层图上 $\text{DFS}$ 找增广路，在回溯时更新剩余容量
3. 不断重复以上步骤直到残量网络中 $\text{St}$ 与 $\text{Ed}$ 不连通

加剪枝和优化后，时间复杂度 **$\mathcal{O(n^2m)}$**

### $\mathcal{Isap}$ 算法

$\mathcal{Dinic}$ 基础上通过只进行一次 $\text{BFS}$ 对于常数进行优化，随机数据下速度在 $\mathcal{Dinic}$ $10$ 倍左右

1. 从 $\text{Ed}$ 到 $\text{St}$ 进行一遍 $\text{BFS}$
2. 从 $\text{St}$ 到 $\text{Ed}$ 进行 $\text{DFS}$，当一个点增广结束后，若此时上一个点传下来的流量比当前点的已用流量大则将它在分层图上的深度 $+1$ ，如果某个深度没有点，则结束算法
3. 若第 $2$ 步没有结束，则重复第 $2$ 步
